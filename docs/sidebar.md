# ğŸ“„ ë°˜ì‘í˜• Sidebar ì œì‘ ë¬¸ì œ

## âš ï¸ë¬¸ì œ

â€œì–´ë–¤ ë¬¸ì œê°€ ìˆì—ˆë‚˜ìš”â€

ë°ìŠ¤í¬í†±ì€ ë§ˆìš°ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  í™”ë©´ì´ í¬ë‹¤. ë°˜ë©´ ëª¨ë°”ì¼ì´ë‚˜ íƒœë¸”ë¦¿ì€ í„°ì¹˜ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•˜ê³  í™”ë©´ì´ ì‘ë‹¤. ì¢‹ì€ ì‚¬ìš©ì ê²½í—˜ì„ ìœ„í•´ì„œëŠ” ì´ ë‘˜ì˜ UI/UXëŠ” ë‹¬ë¼ì ¸ì•¼ë§Œ í•œë‹¤.

ê¸°ê¸°(ëª¨ë°”ì¼ íƒœë¸”ë¦¿, ë°ìŠ¤í¬í†±)ì— ë”°ë¼ ë‹¬ë¼ì§€ëŠ” ì‚¬ì´ë“œë°”ë¥¼ ì–´ë–»ê²Œ êµ¬í˜„í•  ê²ƒì¸ê°€?

## ë ˆí¼ëŸ°ìŠ¤

[í´ë¡œë“œ](https://claude.ai/)ì˜ ì‚¬ì´ë“œë°”ë¥¼ ì°¸ê³ í–ˆë‹¤.

## âœ… ìš”êµ¬ì‚¬í•­ ì„¤ê³„

### ğŸ–¥ ë°ìŠ¤í¬í†± (Desktop)

âœ”ï¸ UI/UX

- ë§ˆìš°ìŠ¤ ì‚¬ìš©ì„ ì „ì œë¡œ í•œ ì¸í„°ë™ì…˜ ì œê³µ
- ì‚¬ì´ë“œë°”ëŠ” í™”ë©´ ì™¼ìª½ì— ë‹¤ë¥¸ ì½˜í…ì¸  ìœ„ì— ë–  ìˆëŠ” í˜•íƒœì´ë‚˜ ê³ ì • ì‹œ í™”ë©´ ì¼ë¶€ë¥¼ ì°¨ì§€í•œë‹¤.

âœ”ï¸ íŠ¸ë¦¬ê±° ì•„ì´ì½˜

- ì•„ì´ì½˜: `LayoutSidebar`
- ì•„ì´ì½˜ ìœ„ì¹˜: ë¡œê³  ì˜¤ë¥¸ìª½
- íŠ¸ë¦¬ê±° ë°©ì‹: `hover`
  - ì‚¬ì´ë“œë°” í‘œì‹œ: ì•„ì´ì½˜ì— hoverí•˜ë©´ ì—´ë¦¼
  - ì‚¬ì´ë“œë°” ìˆ¨ê¹€
    - ì‚¬ì´ë“œë°”ê°€ ê³ ì •ë˜ì§€ ì•Šì€ ê²½ìš°: `mouseleave` ì´ë²¤íŠ¸ ë°œìƒ ì‹œ ë‹«í˜
    - ì‚¬ì´ë“œë°”ê°€ ê³ ì •ëœ ê²½ìš°: ë‹«ì„ ìˆ˜ ì—†ìŒ

âœ”ï¸ ì‚¬ì´ë“œë°” ê³ ì •

- ê³ ì • ë²„íŠ¼ ì•„ì´ì½˜: `RxPin`
- ê³ ì • ë°©ì‹: ì•„ì´ì½˜ í´ë¦­ ì‹œ ê³ ì • ìƒíƒœë¥¼ í† ê¸€

### ğŸ“± ëª¨ë°”ì¼, íƒœë¸”ë¦¿ (Mobile & Tablet)

âœ”ï¸UI/UX ì›ì¹™

- í„°ì¹˜ë¥¼ ì „ì œë¡œ í•œ ì¸í„°ë™ì…˜ ì œê³µ
- ì‚¬ì´ë“œë°”ëŠ” í™”ë©´ ì „ì²´ë¥¼ ë®ëŠ” í˜•íƒœ

âœ”ï¸ íŠ¸ë¦¬ê±° ì•„ì´ì½˜

- ì•„ì´ì½˜: `TiThMenu`
- ì•„ì´ì½˜ ìœ„ì¹˜: ë¡œê³  ì™¼ìª½
- ì•„ì´ì½˜: `TiThMenu`
- íŠ¸ë¦¬ê±° ë°©ì‹: `click`
  - ì‚¬ì´ë“œë°” í‘œì‹œ: ì•„ì´ì½˜ì„ `click`í•˜ë©´ ì—´ë¦¼
  - ì‚¬ì´ë“œë°” ìˆ¨ê¹€: ë‹¤ì‹œ ì•„ì´ì½˜ì„ `click`í•˜ë©´ ë‹«í˜

âœ”ï¸ ì‚¬ì´ë“œë°” ê³ ì • ê¸°ëŠ¥ ì—†ìŒ

## ğŸ” ë¶„ì„

í˜„ì¬ ë°ìŠ¤í¬í†±ì¸ì§€ ì•„ë‹Œì§€ì— ëŒ€í•œ ìƒíƒœ í•„ìš”. `isDesktop`

- ì»´í¬ë„ŒíŠ¸ë¥¼ `isDesktop` ìƒíƒœì— ë”°ë¼ ì¡°ê±´ë¶€ ë Œë”ë§
- tailwind classNameì„ `isDesktop` ìƒíƒœì— ë”°ë¼ ì¡°ê±´ë¶€ë¡œ ì ìš©

## ğŸ’¡ í•´ê²° ë°©ë²• í›„ë³´

1ï¸âƒ£ í™”ë©´ í¬ê¸° ê²€ì‚¬ í›… ì œì‘

2ï¸âƒ£ í™”ë©´ í¬ê¸°ë¥¼ ì „ì—­ ìƒíƒœë¡œ ê´€ë¦¬

3ï¸âƒ£ ê¸°ê¸° ì •ë³´ë¥¼ í™œìš©í•œ ë¶„ê¸° ì²˜ë¦¬ **(ì±„íƒ!)**

## 1ï¸âƒ£ í™”ë©´ í¬ê¸° ê²€ì‚¬ í›… ì œì‘: useIsDesktop

### ğŸ‘â€ğŸ—¨ ì˜ˆì‹œ

ì•„ë˜ì™€ ê°™ì€ í›…ì„ ë§Œë“¤ì–´ì„œ ì‚¬ìš©í•´ ë³´ëŠ” ê±¸ ìƒê°í•´ ë³¼ ìˆ˜ ìˆë‹¤.

```tsx
'use client'

import { useEffect, useState } from 'react'

// useEffectë¥¼ í™œìšœí•´ windowì˜ í¬ê¸°ë¥¼ ê°ì§€í•˜ê³  ì§€ì—­ìƒíƒœì— ì €ì¥í•´ ë°˜í™˜í•œë‹¤.

const useIsDesktop = (): boolean => {
  const [isDesktop, setIsDesktop] = useState(true)

  useEffect(() => {
    const handleResize = () => {
      setIsMobile(window.innerWidth >= 768)
    }

    handleResize()

    window.addEventListener('resize', handleResize)

    return () => {
      window.removeEventListener('resize', handleResize)
    }
  }, [])

  return isDesktop
}

export default useIsDesktop
```

ê·¸ëŸ¬ë©´ ì´ëŸ° ì‹ìœ¼ë¡œ ì‚¬ìš©í•´ ë³¼ ìˆ˜ ìˆë‹¤.

```tsx
'use client'

export default function NavIcon() {
  const isDesktop = useIsDesktop()

  if (isDesktop) {
    return (
      <SidebarHoverTrigger>
        <LayoutSidebar />
      </SidebarHoverTrigger>
    )
  } else {
    return (
      <SidebarTrigger>
        <TiThMenu />
      </SidebarTrigger>
    )
  }
}
```

### ğŸ‘ ì¥ì 

ê°„ë‹¨í•œ êµ¬í˜„

### ğŸ“› ë¬¸ì œì 

- ì¤‘ë³µ ë¬¸ì œ:  
  useIsDesktopë¥¼ ë§ì´ ì‚¬ìš©í•˜ëŠ” ê²½ìš° ë™ì¼í•œ useEffectê°€ ì—¬ëŸ¬ë²ˆ ëŒì•„ê°€ê³ , ë™ì¼í•œ EventListenerê°€ ì—¬ëŸ¬ê°œ ë“±ë¡ëœë‹¤. ë˜í•œ ê°™ì€ ìƒíƒœë¥¼ ê°€ì§„ ì§€ì—­ ìƒíƒœê°€ ì¤‘ë³µí•´ì„œ ì—¬ëŸ¬ ê°œ ìƒê¸´ë‹¤. ì¦‰ ë¹„íš¨ìœ¨ì ì´ë‹¤.

- í™”ë©´ í¬ê¸° ê¸°ë°˜ ë¶„ê¸° ë¬¸ì œ:  
  í™”ë©´ì˜ í¬ê¸°ì— ë”°ë¼ì„œ desktopì¸ì§€ë¥¼ ê²€ì‚¬í•œë‹¤. ê·¸ëŸ¬ë‚˜ ì´ëŠ” ìš”êµ¬ì‚¬í•­ì— ë§ì§€ ì•ŠëŠ”ë‹¤. ìœˆë„ìš° ì°½ì´ ì‘ì•„ì§€ë”ë¼ë„ ì—¬ì „íˆ ë§ˆìš°ìŠ¤ ì‚¬ìš©ì„ ì „ì œë¡œ í•œ ì‚¬ì´ë“œë°”ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.

- Layout Shift ë¬¸ì œ
  ë§ˆìš´íŠ¸(ì²˜ìŒ ë Œë”ë§) í›„ useEffectê°€ ëˆë‹¤. ì¦‰ ì´ˆê¹ƒê°’ì´ useEffect ì´í›„ì— ê°’ê³¼ ë‹¬ë¼ì§€ë©´ ì•„ì´ì½˜ì´ ê°‘ìê¸° ë°”ë€Œê±°ë‚˜ ì‚¬ì´ë“œë°” í¬ê¸°ê°€ ë‹¬ë¼ì§€ëŠ” ë“± í™”ë©´ì´ ê¹œë¹¡ ê±°ë¦¬ê³  Layout Shiftê°€ ì¼ì–´ë‚˜ ì‚¬ìš©ê°ê³¼ ì„±ëŠ¥ì—ë„ ì¢‹ì§€ ì•Šë‹¤.

## 2ï¸âƒ£ í™”ë©´ í¬ê¸°ë¥¼ ì „ì—­ ìƒíƒœë¡œ ê´€ë¦¬: DesktopSizeWatcher

`isDesktop` ìƒíƒœëŠ” ì•± ì „ì²´ì— ê±¸ì³ ì‚¬ìš©ë í…Œë‹ˆê¹Œ ì „ì—­ ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²Œ ì ì ˆí•´ ë³´ì¸ë‹¤.

### ğŸ‘â€ğŸ—¨ ì˜ˆì‹œ

ë¨¼ì € ë°ìŠ¤í¬í†±ì¸ì§€ì— ëŒ€í•œ ì „ì—­ ìƒíƒœë¥¼ ë§Œë“ ë‹¤.

```tsx
import createStore from './utils/create-store'

const isDesktopStore = createStore<boolean>(true)

export default isDesktopStore
```

ê·¸ë¦¬ê³  ì•„ë˜ì™€ ê°™ì€ ì»´í¬ë„ŒíŠ¸ë¥¼ ìµœìƒë‹¨ ë ˆì´ì•„ì›ƒì— ë°•ëŠ” ë°©ë²•ì„ ìƒê°í•´ ë³¼ ìˆ˜ ìˆë‹¤.

```tsx
'use client'

import { useEffect } from 'react'

import isDesktopStore from '#/store/is-desktop-store'

export default function DesktopSizeWatcher() {
  useEffect(() => {
    const mediaQuery = window.matchMedia('(min-width: 768px)')

    const handleMediaQueryChange = (e: MediaQueryListEvent) => {
      isDesktopStore.setState(e.matches)
    }

    // ì´ˆê¸° ë Œë”ë§ ì‹œ í™•ì¸
    isDesktopStore.setState(mediaQuery.matches)

    // ë¯¸ë””ì–´ ì¿¼ë¦¬ ë³€ê²½ ì‹œ ì´ë²¤íŠ¸ ë“±ë¡
    mediaQuery.addEventListener('change', handleMediaQueryChange)

    return () => {
      mediaQuery.removeEventListener('change', handleMediaQueryChange)
    }
  }, [])

  return null
}

//layout.tsx
// ìµœìƒë‹¨ ë ˆì´ì•„ì›ƒì— ë°•ì„ ê²½ìš° useEffectê°€ í•œ ë²ˆë§Œ ëŒë„ ì´ë²¤íŠ¸ ë¦¬ìŠ¤í„°ë„ í•œ ë²ˆ ë“±ë¡ëœë‹¤.
export default async function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode
}>) {
  return (
    <html lang="ko" className={`${pretendard.className} size-full`}>
      <body className="relative size-full">
        <DesktopSizeWatcher />
        <main>{children}</main>
      </body>
    </html>
  )
}
```

ê·¸ë¦¬ê³  ì´ë ‡ê²Œ ì‚¬ìš©í•˜ëŠ” ê±¸ ìƒê°í•´ ë³¼ ìˆ˜ ìˆë‹¤.

```tsx
'use client'

import isDesktopStore from '#/store/is-desktop-store'
import { useStoreSelector } from '#/store/utils/use-store'

export default function NavIcon() {
  const isDesktop = useStoreSelector(isDesktopStore, (state) => state)

  if (isDesktop) {
    return (
      <SidebarHoverTrigger>
        <LayoutSidebar />
      </SidebarHoverTrigger>
    )
  } else {
    return (
      <SidebarTrigger>
        <TiThMenu />
      </SidebarTrigger>
    )
  }
}
```

### ğŸ‘ ì¥ì 

useEffectì™€ EventListnerë¥¼ ìµœì†Œí™” í•  ìˆ˜ ìˆë‹¤. ë˜í•œ isDesktopë¼ëŠ” í•˜ë‚˜ì˜ ìƒíƒœë¥¼ ì „ì—­ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•´ì§„ë‹¤.

### ğŸ“› ë¬¸ì œì 

- ~~ì¤‘ë³µ ë¬¸ì œ.~~ **í•´ê²°**

- í™”ë©´ í¬ê¸° ê¸°ë°˜ ë¶„ê¸° ë¬¸ì œ:  
  í™”ë©´ì˜ í¬ê¸°ì— ë”°ë¼ì„œ desktopì¸ì§€ë¥¼ ê²€ì‚¬í•œë‹¤. ê·¸ëŸ¬ë‚˜ ì´ëŠ” ìš”êµ¬ì‚¬í•­ì— ë§ì§€ ì•ŠëŠ”ë‹¤. ìœˆë„ìš° ì°½ì´ ì‘ì•„ì§€ë”ë¼ë„ ì—¬ì „íˆ ë§ˆìš°ìŠ¤ ì‚¬ìš©ì„ ì „ì œë¡œ í•œ ì‚¬ì´ë“œë°”ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.

- Layout Shift ë¬¸ì œ
  ë§ˆìš´íŠ¸(ì²˜ìŒ ë Œë”ë§) í›„ useEffectê°€ ëˆë‹¤. ì¦‰ ì´ˆê¹ƒê°’ì´ useEffect ì´í›„ì— ê°’ê³¼ ë‹¬ë¼ì§€ë©´ ì•„ì´ì½˜ì´ ê°‘ìê¸° ë°”ë€Œê±°ë‚˜ ì‚¬ì´ë“œë°” í¬ê¸°ê°€ ë‹¬ë¼ì§€ëŠ” ë“± í™”ë©´ì´ ê¹œë¹¡ ê±°ë¦¬ê³  Layout Shiftê°€ ì¼ì–´ë‚˜ ì‚¬ìš©ê°ê³¼ ì„±ëŠ¥ì—ë„ ì¢‹ì§€ ì•Šë‹¤.

**ì—¬ì „íˆ 1ï¸âƒ£ useIsDesktopì—ë„ ë‘ ê°€ì§€ ë¬¸ì œê°€ ë‚¨ëŠ”ë‹¤.**

## 3ï¸âƒ£ ê¸°ê¸° ì •ë³´ë¥¼ í™œìš©í•œ ë¶„ê¸° ì²˜ë¦¬: User-Agent

ë¨¼ì € ê¸°ê¸° ì •ë³´ë¥¼ ì•Œ ìˆ˜ ìˆëŠ” User-Agentë¥¼ ì•Œì•„ë³´ì.

### ğŸ”User-Agentë€?

User-Agent(UA)ëŠ” ì›¹ ë¸Œë¼ìš°ì €, ëª¨ë°”ì¼ ì•±, ë´‡ ë“± ì‚¬ìš©ìì˜ í´ë¼ì´ì–¸íŠ¸ê°€ ì›¹ ì„œë²„ì™€ í†µì‹ í•  ë•Œ ìì‹ ì„ ì‹ë³„í•˜ê¸° ìœ„í•´ ì „ì†¡í•˜ëŠ” HTTP ìš”ì²­ í—¤ë” ì¤‘ í•˜ë‚˜ë‹¤.

#### User-Agentì˜ ì—­í• 

1. í´ë¼ì´ì–¸íŠ¸ ì‹ë³„

- ìš”ì²­ì„ ë³´ë‚¸ ë¸Œë¼ìš°ì €(Chrome, Safari, Edge ë“±) ë˜ëŠ” ì•±ì´ ë¬´ì—‡ì¸ì§€ ì•Œë ¤ì¤Œ
- ìš´ì˜ ì²´ì œ(Windows, macOS, Android ë“±) ì •ë³´ í¬í•¨
- íŠ¹ì • ê¸°ê¸° ì •ë³´(iPhone, Samsung ë“±) í¬í•¨

2. ì›¹ì‚¬ì´íŠ¸ ìµœì í™”

- ì›¹ ì„œë²„ê°€ íŠ¹ì • ë¸Œë¼ìš°ì €ë‚˜ ë””ë°”ì´ìŠ¤ì— ë§ì¶° ì½˜í…ì¸ ë¥¼ ìµœì í™”í•˜ì—¬ ì œê³µ ê°€ëŠ¥
- ì˜ˆ: ëª¨ë°”ì¼ì—ì„œëŠ” ê°€ë²¼ìš´ UIë¥¼ ì œê³µí•˜ê³ , ë°ìŠ¤í¬í†±ì—ì„œëŠ” í’€ ê¸°ëŠ¥ì„ ì œê³µ

3. ë¶„ì„ ë° ë¡œê·¸ ê¸°ë¡

- ì›¹ì‚¬ì´íŠ¸ ë°©ë¬¸ìì˜ ì‚¬ìš© í™˜ê²½ì„ ë¶„ì„í•˜ì—¬ íŠ¸ë Œë“œ íŒŒì•… ê°€ëŠ¥
- ë³´ì•ˆ ëª©ì ìœ¼ë¡œ íŠ¹ì • User-Agent ì°¨ë‹¨ ê°€ëŠ¥ (ì˜ˆ: ì•…ì„± ë´‡ ì°¨ë‹¨)

#### User-Agent ì˜ˆì œ

1. Chrome ë¸Œë¼ìš°ì € (Windows 10)

```swift
Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
```

- Mozilla/5.0: ê³¼ê±° ë„·ìŠ¤ì¼€ì´í”„ ë¸Œë¼ìš°ì €ì™€ì˜ í˜¸í™˜ì„±ì„ ìœ„í•´ ìœ ì§€ë˜ëŠ” ë¶€ë¶„
- Windows NT 10.0; Win64; x64: Windows 10 ìš´ì˜ ì²´ì œ, 64ë¹„íŠ¸ ì•„í‚¤í…ì²˜
- AppleWebKit/537.36: Chromeì´ ì‚¬ìš©í•˜ëŠ” ë Œë”ë§ ì—”ì§„ (WebKit ê¸°ë°˜)
- Chrome/120.0.0.0: Chrome ë¸Œë¼ìš°ì € ë²„ì „
- Safari/537.36: Safariì™€ì˜ í˜¸í™˜ì„±ì„ ìœ ì§€í•˜ê¸° ìœ„í•œ ì •ë³´

2. iPhone Safari (iOS 16)

```swift
Mozilla/5.0 (iPhone; CPU iPhone OS 16_0 like Mac OS X) AppleWebKit/537.36 (KHTML, like Gecko) Version/16.0 Mobile/15E148 Safari/537.36
```

- iPhone; CPU iPhone OS 16_0 like Mac OS X: iOS 16ì„ ì‚¬ìš©í•˜ëŠ” iPhone
- Mobile: ëª¨ë°”ì¼ ì¥ì¹˜ì„ì„ ë‚˜íƒ€ëƒ„
- Safari/537.36: Safari ë¸Œë¼ìš°ì €

#### User-Agent ë³€ê²½ ë° í™œìš©

1. User-Agent ìŠ¤í‘¸í•‘

- ê°œë°œì ë„êµ¬(F12)ì—ì„œ ë‹¤ë¥¸ User-Agentë¡œ ë³€ê²½í•˜ì—¬ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
- ë¸Œë¼ìš°ì € í™•ì¥ í”„ë¡œê·¸ë¨(User-Agent Switcher)ìœ¼ë¡œ ë³€ê²½ ê°€ëŠ¥
- ì„œë²„ê°€ User-Agent ê¸°ë°˜ìœ¼ë¡œ ë‹¤ë¥´ê²Œ ì‘ë‹µí•˜ëŠ”ì§€ í™•ì¸ ê°€ëŠ¥

2. User-Agent ê¸°ë°˜ ëŒ€ì‘

- ëª¨ë°”ì¼/ë°ìŠ¤í¬í†± ì „í™˜ (ì˜ˆ: window.navigator.userAgent ì‚¬ìš©)
- íŠ¹ì • ë´‡(User-Agent ë¶„ì„) ì°¨ë‹¨

#### User-Agent ê´€ë ¨ ë¬¸ì œì 

1. User-Agent ìŠ¤í‘¸í•‘

- ì¼ë¶€ ì‚¬ìš©ìê°€ ë‹¤ë¥¸ ë¸Œë¼ìš°ì €ë¡œ ê°€ì¥í•  ìˆ˜ ìˆìŒ
- ë´‡ì´ë‚˜ ìŠ¤í¬ë˜í¼ê°€ ì •êµí•œ User-Agentë¥¼ ì‚¬ìš©í•´ ì°¨ë‹¨ íšŒí”¼ ê°€ëŠ¥

2. ë¸Œë¼ìš°ì €ë³„ ì°¨ì´

- ë¸Œë¼ìš°ì €ë§ˆë‹¤ ë‹¤ë¥¸ User-Agent í¬ë§·ì„ ì‚¬ìš©í•˜ì—¬ ì²˜ë¦¬ ë³µì¡

3. Privacy ì´ìŠˆ

- User-Agent ì •ë³´ë¥¼ í†µí•´ íŠ¹ì • ì‚¬ìš©ì ë˜ëŠ” ê¸°ê¸°ë¥¼ ì¶”ì í•  ê°€ëŠ¥ì„± ìˆìŒ
- ì¼ë¶€ ë¸Œë¼ìš°ì €(ì˜ˆ: ìµœì‹  Chrome, Firefox)ëŠ” User-Agentë¥¼ ì ì§„ì ìœ¼ë¡œ íì§€í•˜ê³  User-Agent Client Hintsë¡œ ëŒ€ì²´ ì¤‘

#### ì •ë¦¬

- User-AgentëŠ” ì›¹ ì„œë²„ê°€ í´ë¼ì´ì–¸íŠ¸ë¥¼ ì‹ë³„í•˜ëŠ” ì¤‘ìš”í•œ HTTP í—¤ë”
- User-Agent ê¸°ë°˜ ìµœì í™”ë³´ë‹¤ëŠ” ë°˜ì‘í˜• ì›¹ ë””ìì¸, ê¸°ëŠ¥ ê°ì§€(feature detection) ë“±ì„ í™œìš©í•˜ëŠ” ê²ƒì´ ë” ë°”ëŒì§í•¨
- Privacy ì´ìŠˆë¡œ ì¸í•´ User-Agent Client Hintsë¡œ ì „í™˜ì´ ì§„í–‰ ì¤‘

## ğŸ”Next.js: headers

Next.jsì—ì„œ ì œê³µí•˜ëŠ” headers í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ User-Agentì— ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤.

headers í•¨ìˆ˜ëŠ” ì„œë²„ ì»´í¬ë„ŒíŠ¸ì—ì„œ HTTP ìˆ˜ì‹  ìš”ì²­ í—¤ë”ë¥¼ ì½ì„ ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤.

```tsx
import { headers } from 'next/headers'

export default async function Page() {
  const headersList = await headers()
  const userAgent = headersList.get('user-agent')
}
```

ê·¸ë ‡ë‹¤ë©´ ì„œë²„ ì»´í¬ë„ŒíŠ¸ì—ì„œ User-Agent ì •ë³´ë¥¼ ì´ìš©í•˜ëŠ” ë°©ë²•ì„ ìƒê°í•´ ë³¼ ìˆ˜ ìˆë‹¤.

### ğŸ‘â€ğŸ—¨ ì˜ˆì‹œ

ì˜ˆë¥¼ ë“¤ë©´ ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš©í•´ ë³¼ ìˆ˜ ìˆë‹¤.

headers í•¨ìˆ˜ì™€ User-Agent ì •ë³´ë¥¼ ê°€ì§€ê³  `mobile`ì¸ì§€ `desktop`ì¸ì§€ `tablet`ì¸ì§€ ë°˜í™˜í•˜ëŠ” util í•¨ìˆ˜ classifyDeviceType ë§Œë“¤ì–´ ì‚¬ìš©í•´ ë³´ì.

```tsx
'use server'

import { headers } from 'next/headers'

// ê¸°ê¸° íƒ€ì… 3ê°€ì§€
type DeviceType = 'mobile' | 'desktop' | 'tablet'

export default async function NavIcon() {
  const headersList = await headers()
  const userAgent = headersList.get('user-agent')

  // userAgent DeviceType
  //classifyDeviceType: (userAgent: string) =>DeviceType
  const isDesktop = classifyDeviceType(userAgent) === 'desktop'

  if (isDesktop) {
    return (
      <SidebarHoverTrigger>
        <LayoutSidebar />
      </SidebarHoverTrigger>
    )
  } else {
    return (
      <SidebarTrigger>
        <TiThMenu />
      </SidebarTrigger>
    )
  }
}
```

classifyDeviceTypeì€ ë‚´ë¶€ë‹¤. ì •ê·œì‹ì„ ì‚¬ìš©í•´ ê¸°ê¸°ë¥¼ ë¶„ë¥˜í•œë‹¤.

```ts
type DeviceType = 'mobile' | 'desktop' | 'tablet'

const classifyDeviceType = (userAgent: string): DeviceType => {
  // iPad íŠ¹ì • íŒ¨í„´ (iPadOS 13+)
  const iPadRegex = /iPad|Mozilla.*Mac OS.*Safari|Macintosh.\*Safari/i

  // Mac ì „ìš© íŒ¨í„´ (iPad ì œì™¸)
  const macRegex = /Macintosh.*Chrome|Macintosh.*Firefox|Macintosh.\*Edge/i

  // ëª¨ë°”ì¼ íŒ¨í„´
  const mobileRegex = new RegExp(
    [
      'Mobile',
      'Android.*Mobile',
      'iPhone',
      'iPod',
      'BlackBerry',
      'IEMobile',
      'Opera Mini',
      'Windows Phone',
      'webOS',
      'Palm',
      'SamsungBrowser',
      'Opera Mobi',
      'Opera Mobile',
      'Mobile Safari',
      'SymbianOS',
      'Series60',
      'S60',
      'MeeGo',
      'Firefox.*Mobile',
      'MicroMessenger',
    ].join('|'),
    'i',
  )

  // ì¼ë°˜ íƒœë¸”ë¦¿ íŒ¨í„´
  const tabletRegex = new RegExp(
    [
      'Android(?!.*Mobile)',
      'Kindle',
      'PlayBook',
      'Silk',
      'Tablet',
      'Nexus(?!.*Mobile)',
      'KFAPWI',
      'RIM Tablet',
      'HP TouchPad',
      'Shield Tablet',
    ].join('|'),
    'i',
  )

  // iPad ì²´í¬
  if (iPadRegex.test(userAgent) && !macRegex.test(userAgent)) {
    return 'tablet'
  }

  // Mac ì²´í¬
  if (macRegex.test(userAgent)) {
    return 'desktop'
  }

  // ì¼ë°˜ íƒœë¸”ë¦¿ ì²´í¬
  if (tabletRegex.test(userAgent) && !mobileRegex.test(userAgent)) {
    return 'tablet'
  }

  // ëª¨ë°”ì¼ ì²´í¬
  if (mobileRegex.test(userAgent)) {
    return 'mobile'
  }

  // ê¸°ë³¸ê°’
  return 'desktop'
}
```

### ğŸ‘ ì¥ì 

ì„œë²„ì—ì„œ `headers`ë¥¼ ì´ìš©í•˜ì—¬ ê¸°ê¸° ì •ë³´ë¥¼ ì •í™•í•˜ê²Œ ê°ì§€í•˜ë¯€ë¡œ,useEffectë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì•„ë„ ë˜ê³ , í´ë¼ì´ì–¸íŠ¸ì—ì„œ ë¶ˆí•„ìš”í•œ ë Œë”ë§ ì´ìŠˆë¥¼ ë°©ì§€í•œë‹¤. ê·¸ë¦¬ê³  í™”ë©´ í¬ê¸°ë¡œ ê¸°ê¸°ë¥¼ êµ¬ë¶„í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆê¸° ë•Œë¬¸ì— ë§ˆìš°ìŠ¤ ì‚¬ìš©ê³¼ í„°ì¹˜ì— ë”°ë¥¸ ì¸í„°ë™ì…˜ì„ í•­ìƒ ì œê³µí•  ìˆ˜ ìˆê²Œ ëœë‹¤.

### ğŸ“› ë¬¸ì œì 

- ~~ì¤‘ë³µ ë¬¸ì œ.~~ **í•´ê²°**

- ~~í™”ë©´ í¬ê¸° ê¸°ë°˜ ë¶„ê¸° ë¬¸ì œ~~ **í•´ê²°**

- ~~Layout Shift ë¬¸ì œ~~ **í•´ê²°**

## ğŸŸ¡ ê²°ë¡  ë° ìš”ì•½

ê¸°ê¸°ì— ë”°ë¥¸ ë°˜ì‘í˜• ì‚¬ì´ë“œë°”ë¥¼ ì–´ë–»ê²Œ ì œì‘í•  ê²ƒì¸ê°€?

| ë°©ë²•                 | ì¥ì                               | ë‹¨ì                                                       |
| -------------------- | --------------------------------- | --------------------------------------------------------- |
| useIsDesktop í›…      | ê°„ë‹¨í•œ êµ¬í˜„                       | ìƒíƒœì™€ ì´ë²¤íŠ¸ê°€ ì¤‘ë³µë˜ê³  ë¹„íš¨ìœ¨ì ì´ë©° Layout Shift ë°œìƒ   |
| ì „ì—­ ìƒíƒœ ê´€ë¦¬       | useEffect ë° EventListener ìµœì†Œí™” | ì—¬ì „íˆ í™”ë©´ í¬ê¸° ê¸°ë°˜ ë¶„ê¸°ë¼ ìš”êµ¬ì‚¬í•­ê³¼ ë‹¤ë¦„              |
| User-Agent ê¸°ë°˜ ì²˜ë¦¬ | ì„œë²„ì—ì„œ ê¸°ê¸° ì •ë³´ë¥¼ ì •í™•íˆ ê°ì§€  | User-Agent ìŠ¤í‘¸í•‘ ê°€ëŠ¥ì„±ì´ ìˆì§€ë§Œ ëŒ€ë¶€ë¶„ì˜ ê²½ìš° ë¬¸ì œ ì—†ìŒ |

ê²°ë¡ ì ìœ¼ë¡œ **User-Agent ê¸°ë°˜ ë¶„ê¸° ì²˜ë¦¬**ê°€ ê°€ì¥ ì ì ˆí•œ í•´ê²°ì±…ì´ë‹¤.

## ğŸ”µ ë§ˆë¬´ë¦¬ ë° ê³ ë ¤ ì‚¬í•­

- **User-Agent ìŠ¤í‘¸í•‘ ë¬¸ì œ**: ì¼ë¶€ ì‚¬ìš©ìê°€ User-Agentë¥¼ ì¡°ì‘í•  ìˆ˜ ìˆì§€ë§Œ, ì¼ë°˜ì ì¸ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œëŠ” í° ë¬¸ì œê°€ ë˜ì§€ ì•ŠìŒ.
- **í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì¶”ê°€ì ì¸ ì²˜ë¦¬ ê°€ëŠ¥**: í•„ìš”í•  ê²½ìš° `useEffect`ë¥¼ í™œìš©í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì¶”ê°€ì ì¸ ê²€ì¦ì„ í•  ìˆ˜ë„ ìˆìŒ.

## ğŸŸ£ ìµœì¢… ì‚¬ìš© ì˜ˆì‹œ ì½”ë“œ

root layout.tsx -> ê¸°ê¸° ì •ë³´ í™•ì¸

```tsx
export default async function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode
}>) {
  const loggedIn = (await getCookie('auth')) === 'true'
  const deviceType = await getDeviceType()

  return (
    <html lang="ko" className={`${pretendard.className} size-full`}>
      <body className="relative size-full">
        <SidebarProvider
          isDesktop={deviceType === 'desktop'}
          loggedIn={loggedIn}
        >
          <Header />
          <AppSidebar />
          <Main className="overflow-x-hidden pt-12">{children}</Main>
        </SidebarProvider>
      </body>
    </html>
  )
}
```

SidebarProvider -> Desktopì¸ì§€ì— ëŒ€í•œ ì •ë³´ë¥¼ `isDesktop`ì— ë‹´ì•„ contextë¡œ ë„˜ê²¨ì£¼ì–´ ì‚¬ì´ë“œë°” ì»´í¬ë„ŒíŠ¸ ì•ˆì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•œë‹¤.

```tsx
export function SidebarProvider({
  children,
  isDesktop,
  loggedIn,
}: SidebarProviderProps) {
  const [open, setOpen] = useState(false)
  const [pinned, setPinned] = useState(false)

  const value: SidebarContextType = {
    open,
    pinned,
    setOpen,
    setPinned,
    isDesktop,
    loggedIn,
  }

  return (
    <SidebarContext.Provider value={value}>{children}</SidebarContext.Provider>
  )
}
```

SidebarPinButton -> `isDesktop` í™œìš© ì˜ˆì‹œ, pin ë²„íŠ¼ì€ íƒœë¸”ë¦¿ì—ì„œë§Œ ë³´ì—¬ì•¼ í•œë‹¤.

```tsx
export function SidebarPinButton({ children, className }: ClassNameProp) {
  const { setPinned, isDesktop } = useSidebar()
  const toggle = () => {
    setPinned((prev) => !prev)
  }

  if (isDesktop) {
    return (
      <button
        className={cn(
          'p-2 mb-3 transition-all duration-300 ease-in-out rounded-lg',
          'hover:scale-105 active:scale-95',
          'hover:bg-accent',
          className,
        )}
        onClick={toggle}
      >
        {children}
      </button>
    )
  }
}
```
